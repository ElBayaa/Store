<div ng-controller="SettingsCtrl" ng-init="setSettings(<%= @settings.to_json%>)">
  
  <form name="settingForm" ng-submit="settingForm.$valid && (new_setting.id? updateSetting() : createSetting())" novalidate>
     
    <ul>
      <li ng-repeat="error in model_errors" ng-show="model_errors">
        {{error}}
      </li>
    </ul>

    <select ng-model="new_setting.data_type" ng-options="type for type in ['String', 'Integer', 'Float', 'Boolean']">
    </select>
    
    <input type="text" ng-model="new_setting.key" class="validation" placeholder="key" required/>
    
    <input type="text" ng-model="new_setting.value" ng-if="new_setting.data_type == 'String'" class="validation" placeholder="value"/>
    <input type="number" ng-model="new_setting.value" ng-if="new_setting.data_type == 'Integer'" class="validation" placeholder="0" required ng-pattern="/^-?\d+$/"/>
    <input type="number" ng-model="new_setting.value" ng-if="new_setting.data_type == 'Float'" class="validation" placeholder="0.0">
    <select ng-model="new_setting.value" ng-init="new_setting.value=true" ng-options="bool for bool in [true, false]" ng-if="new_setting.data_type == 'Boolean'">      
    </select>

    <input type="submit" value="{{new_setting.id ? 'Update' : 'Create'}}"/>

  </form>

  <table>
    <tbody>
      <tr ng-hide="new_setting.id">
        <td>{{new_setting.key}}</td>
        <td>{{new_setting.value}}</td>
      </tr>
      <tr ng-repeat="setting in settings" ng-dblclick="editSetting(setting)">
        <td>{{setting.key}}</td>
        <td>{{setting.value}}</td>
        <td><button ng-click="deleteSetting(setting, $index)">Delete</button></td>
      </tr>
    </tbody>
  </table>
</div>